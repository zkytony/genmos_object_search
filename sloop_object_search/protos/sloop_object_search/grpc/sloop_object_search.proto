// Top-level services. For example, start the sloop object search server

syntax = "proto3";

package sloop_object_search.grpc;

import "sloop_object_search/grpc/common.proto";
import "sloop_object_search/grpc/observation.proto";


service SloopObjectSearch {

  rpc CreateAgent(CreateAgentRequest) returns (CreateAgentReply) {}

  // More fine-grained rpcs for specific functionality
  rpc UpdateSearchRegion(UpdateSearchRegionRequest) returns (UpdateSearchRegionReply) {}

}


////////////// Create agent
message CreateAgentRequest {
  // agent name
  string agent_name = 1;

  // serialized configuration dictionary
  bytes config = 2;

  // initial pose
  oneof init_pose {
    Pose2D init_pose_2d = 3;
    Pose3D init_pose_3d = 4;
  }

  // initial model of the search environment
  oneof search_region {
    OccupancyGrid occupancy_grid = 5;
    PointCloud point_cloud = 6;
  }

  // Parameters for search region
  oneof search_region_params {
    SearchRegionParams2D search_region_params_2d = 7;
  }
}

message CreateAgentReply {
  sloop_object_search.grpc.Status status = 1;
  string message = 2;
}

///////////// Search region related
message SearchRegionParams2D {
  double layout_cut = 1;
}


message UpdateSearchRegionRequest {
  // robot pose
  oneof robot_pose {
    Pose2D robot_pose_2d = 3;
    Pose3D robot_pose_3d = 4;
  }

  oneof search_region {
    OccupancyGrid occupancy_grid = 5;
    PointCloud point_cloud = 6;
  }

  oneof search_region_params {
    SearchRegionParams2D search_region_params_2d = 7;
  }
}

message UpdateSearchRegionReply {
  sloop_object_search.grpc.Status status = 1;
  string message = 2;
}
